\hypertarget{_renderer_8cpp_source}{}\doxysection{Renderer.\+cpp}
\label{_renderer_8cpp_source}\index{Source/Renderer.cpp@{Source/Renderer.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include} \mbox{\hyperlink{_renderer_8hpp}{"Renderer.hpp"}}}
\DoxyCodeLine{00002 }
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#}\textcolor{preprocessor}{include} \mbox{\hyperlink{_g_l_context_manager_8hpp}{"GLContextManager.hpp"}}}
\DoxyCodeLine{00004 }
\DoxyCodeLine{00005 \textcolor{keyword}{namespace} \mbox{\hyperlink{namespace_b_a_r_e2_d}{BARE2D}} \{}
\DoxyCodeLine{00006 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00007}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_abc605847b99b92971a385206dc75e044}{00007}}     \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_abc605847b99b92971a385206dc75e044}{Renderer}}()}
\DoxyCodeLine{00008     \{}
\DoxyCodeLine{00009     \}}
\DoxyCodeLine{00010 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00011}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a827d8f3a5ec209a3d06bb3667554a091}{00011}}     \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\string~\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a827d8f3a5ec209a3d06bb3667554a091}{Renderer}}()}
\DoxyCodeLine{00012     \{}
\DoxyCodeLine{00013     \}}
\DoxyCodeLine{00014 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00015}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a7b894142f30465231e74903f366cd70a}{00015}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a7b894142f30465231e74903f366cd70a}{begin}}() \{}
\DoxyCodeLine{00016         \textcolor{comment}{// Clears renderbatches to make space for new ones!}}
\DoxyCodeLine{00017         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}.clear();}
\DoxyCodeLine{00018     \}}
\DoxyCodeLine{00019 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00020}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a8a07d633d12883604201fd032fbd2cdd}{00020}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a8a07d633d12883604201fd032fbd2cdd}{end}}() \{}
\DoxyCodeLine{00021         \textcolor{comment}{// Nothing special really needs to be done here.}}
\DoxyCodeLine{00022     \}}
\DoxyCodeLine{00023 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00024}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_addafa95f7a6f451e359d1300031bdde1}{00024}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_addafa95f7a6f451e359d1300031bdde1}{init}}()}
\DoxyCodeLine{00025     \{}
\DoxyCodeLine{00026         \textcolor{comment}{// Set depth range so that we can actually write depth values.}}
\DoxyCodeLine{00027         glDepthRange(0.0f, 1.0f);}
\DoxyCodeLine{00028 }
\DoxyCodeLine{00029         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a95e6c292d64ff927870783e464ad49cd}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a95e6c292d64ff927870783e464ad49cd}{init}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a95e6c292d64ff927870783e464ad49cd}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a95e6c292d64ff927870783e464ad49cd}{)}};}
\DoxyCodeLine{00030     \}}
\DoxyCodeLine{00031 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00032}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a62d8bb52afdd8a38f96fe89677e03f53}{00032}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a62d8bb52afdd8a38f96fe89677e03f53}{destroy}}()}
\DoxyCodeLine{00033     \{}
\DoxyCodeLine{00034         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a1932f8495f96a00b61f300b6220357da}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a1932f8495f96a00b61f300b6220357da}{destroy}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a1932f8495f96a00b61f300b6220357da}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a1932f8495f96a00b61f300b6220357da}{)}};}
\DoxyCodeLine{00035         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a5b58eb971ff8352683380938e263e9ad}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a5b58eb971ff8352683380938e263e9ad}{destroy}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a5b58eb971ff8352683380938e263e9ad}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a5b58eb971ff8352683380938e263e9ad}{)}};}
\DoxyCodeLine{00036     \}}
\DoxyCodeLine{00037 }
\DoxyCodeLine{\Hypertarget{_renderer_8cpp_source_l00038}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_af6c7b543d54be3ce30224e21d5606be3}{00038}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer}{Renderer}}::\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_af6c7b543d54be3ce30224e21d5606be3}{render}}()}
\DoxyCodeLine{00039     \{}
\DoxyCodeLine{00040         \textcolor{comment}{// Ensure that we're actually using the shader for the glDrawArrays call!}}
\DoxyCodeLine{00041         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a8687213986c6f5633887609e8169b24e}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a8687213986c6f5633887609e8169b24e}{use}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a8687213986c6f5633887609e8169b24e}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a8687213986c6f5633887609e8169b24e}{)}};}
\DoxyCodeLine{00042 }
\DoxyCodeLine{00043         \textcolor{comment}{// Make sure we're in the regular rendering texture (arbitrarily set to texture0, just for consistency)}}
\DoxyCodeLine{00044         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context}{GLContext}}* glContext = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_manager}{GLContextManager}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_manager_a733646522bf07c33576f9a1e0bb76c28}{::}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_manager_a733646522bf07c33576f9a1e0bb76c28}{getContext}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_manager_a733646522bf07c33576f9a1e0bb76c28}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_manager_a733646522bf07c33576f9a1e0bb76c28}{)}};}
\DoxyCodeLine{00045         glContext\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{-\/>}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{setActiveTexture}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{(}}GL\_TEXTURE0\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{)}};}
\DoxyCodeLine{00046 }
\DoxyCodeLine{00047         \textcolor{comment}{// First we must bind the vertex array object and vertex buffer object}}
\DoxyCodeLine{00048         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a61c99f69bf5feb2ac95189381a48e638}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a61c99f69bf5feb2ac95189381a48e638}{bind}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a61c99f69bf5feb2ac95189381a48e638}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a61c99f69bf5feb2ac95189381a48e638}{)}};}
\DoxyCodeLine{00049 }
\DoxyCodeLine{00050         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a9aab9d938c89c6d3d9c4ff6de02d3c4d}{preRender}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a9aab9d938c89c6d3d9c4ff6de02d3c4d}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a9aab9d938c89c6d3d9c4ff6de02d3c4d}{)}};}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052         \textcolor{comment}{// Create RenderBatches (uploading them to the bound texture, so that we can actually draw them next.}}
\DoxyCodeLine{00053         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_abf344beacb334d74a7c5c2d15815fe4f}{createRenderBatches}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_abf344beacb334d74a7c5c2d15815fe4f}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_abf344beacb334d74a7c5c2d15815fe4f}{)}};}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055         \textcolor{comment}{// Now we can render each renderbatch, uploading their texture data respectively.}}
\DoxyCodeLine{00056         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}.size(); i++) \{}
\DoxyCodeLine{00057             \textcolor{comment}{// Bind the texture information to the texture "slot" }}
\DoxyCodeLine{00058             \textcolor{comment}{// This method of binding the textures decreases speed slightly for completely random textures, but if we are rendering a lot of the same texture, this is similar (if not identical) to instance rendering}}
\DoxyCodeLine{00059             glContext\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{-\/>}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{bindTexture}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{(}}GL\_TEXTURE\_2D\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{,}} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}[i]\mbox{\hyperlink{class_render_batch_af46637d6c7713d32bf3d89cb8cfcc7d3}{.}}\mbox{\hyperlink{class_render_batch_af46637d6c7713d32bf3d89cb8cfcc7d3}{textureID}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{)}};}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061             \textcolor{comment}{// Upload the data}}
\DoxyCodeLine{00062             glDrawArrays(GL\_TRIANGLES, (GLint)\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}[i]\mbox{\hyperlink{class_render_batch_abcbeaacf6d5ca1f78c8a270c6975e827}{.}}\mbox{\hyperlink{class_render_batch_abcbeaacf6d5ca1f78c8a270c6975e827}{offset}}, (GLsizei)\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}[i]\mbox{\hyperlink{class_render_batch_ac80bf0479536f10923a8bdb50598217a}{.}}\mbox{\hyperlink{class_render_batch_ac80bf0479536f10923a8bdb50598217a}{numVertices}});}
\DoxyCodeLine{00063         \}}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065         \textcolor{comment}{// Unbind for safety!}}
\DoxyCodeLine{00066         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a6c224737a43f43dbe7c9e25ecd47d1da}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a6c224737a43f43dbe7c9e25ecd47d1da}{unbind}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a6c224737a43f43dbe7c9e25ecd47d1da}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a6c224737a43f43dbe7c9e25ecd47d1da}{)}};}
\DoxyCodeLine{00067 }
\DoxyCodeLine{00068         \textcolor{comment}{// Release the shader}}
\DoxyCodeLine{00069         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a7847844b8a2e5ab0677340b47d180841}{.}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a7847844b8a2e5ab0677340b47d180841}{unuse}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a7847844b8a2e5ab0677340b47d180841}{(}}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a7847844b8a2e5ab0677340b47d180841}{)}};}
\DoxyCodeLine{00070     \}}
\DoxyCodeLine{00071 }
\DoxyCodeLine{00072 \}}

\end{DoxyCode}
