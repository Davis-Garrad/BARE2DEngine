\hypertarget{_bumpy_renderer_8cpp_source}{}\doxysection{Bumpy\+Renderer.\+cpp}
\label{_bumpy_renderer_8cpp_source}\index{Source/BumpyRenderer.cpp@{Source/BumpyRenderer.cpp}}
\mbox{\hyperlink{_bumpy_renderer_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_bumpy_renderer_8hpp}{BumpyRenderer.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_g_l_context_manager_8hpp}{GLContextManager.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00005}00005 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_b_a_r_e2_d}{BARE2D}} \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00007}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph_afe7eb427ad2e80ed7f5795a70affe529}{00007}}     \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph_afe7eb427ad2e80ed7f5795a70affe529}{BumpyGlyph::BumpyGlyph}}(glm::vec4\& destRect, glm::vec4\& uvRect, GLuint\& \mbox{\hyperlink{struct_b_a_r_e2_d_1_1_texture}{Texture}}, GLuint\& Bumpmap, \textcolor{keywordtype}{float}\& Depth, \mbox{\hyperlink{struct_b_a_r_e2_d_1_1_colour}{Colour}}\& colour, \textcolor{keywordtype}{float}\& angle, glm::vec2\& COR)}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00008}00008         : \mbox{\hyperlink{class_b_a_r_e2_d_1_1_glyph}{Glyph}}(destRect, uvRect, \mbox{\hyperlink{struct_b_a_r_e2_d_1_1_texture}{Texture}}, Depth, colour, angle, COR), bumpmap(Bumpmap) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00010}00010     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00012}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a87e27c42fb9f184113799f7711a79961}{00012}}     \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a87e27c42fb9f184113799f7711a79961}{BumpyRenderer::BumpyRenderer}}(std::string\& fragShader, std::string\& vertShader, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} perspectiveWidth, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} perspectiveHeight)}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00013}00013         : \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer}{BasicRenderer}}(fragShader, vertShader, perspectiveWidth, perspectiveHeight) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00014}00014     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00016}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a3ac0dc2f5f0a67903b28f2a34070aa3c}{00016}}     \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a3ac0dc2f5f0a67903b28f2a34070aa3c}{BumpyRenderer::\string~BumpyRenderer}}() \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00017}00017     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00019}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a6700a581c23f6874f4547ea80d4f4535}{00019}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a6700a581c23f6874f4547ea80d4f4535}{BumpyRenderer::initUniforms}}() \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00020}00020         GLint textureUniform = 0;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00021}00021         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a70aa79c9886b261f8380985ca20a487d}{setUniform}}(\textcolor{stringliteral}{"{}textureSampler"{}}, \&textureUniform);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00023}00023         GLint bumpUniform = 1;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00024}00024         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a70aa79c9886b261f8380985ca20a487d}{setUniform}}(\textcolor{stringliteral}{"{}bumpmapSampler"{}}, \&bumpUniform);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00025}00025     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00027}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a33dd21c340b2ea4cdfda0c4306883275}{00027}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a33dd21c340b2ea4cdfda0c4306883275}{BumpyRenderer::preRender}}() \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00028}00028         \textcolor{comment}{// We need to define a texture sampler for textures AND bumpmaps!}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00029}00029         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a741e3e451e464391ae3c549ec34866db}{m\_camera}}-\/>update();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00031}00031         glm::mat4 projectionMatrix = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a741e3e451e464391ae3c549ec34866db}{m\_camera}}-\/>getCameraMatrix();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00032}00032         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_adfa74453d9bc2f1100e5d19bb45a5512}{setUniformMatrix}}<glm::mat4>(\textcolor{stringliteral}{"{}projectionMatrix"{}}, GL\_FALSE, \&projectionMatrix);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00033}00033     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00035}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_adf8f29d89f859671a39cde7fb94cc7e7}{00035}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_adf8f29d89f859671a39cde7fb94cc7e7}{BumpyRenderer::render}}() \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00036}00036         \textcolor{comment}{// Ensure that we're actually using the shader for the glDrawArrays call!}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00037}00037         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a8687213986c6f5633887609e8169b24e}{use}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00039}00039         \textcolor{comment}{// Make sure we're in the regular rendering texture (arbitrarily set to texture0, just for consistency)}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00040}00040         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context}{GLContext}}* glContext = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_manager_a733646522bf07c33576f9a1e0bb76c28}{GLContextManager::getContext}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00041}00041         glContext-\/>\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{setActiveTexture}}(GL\_TEXTURE0);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00043}00043         \textcolor{comment}{// First we must bind the vertex array object and vertex buffer object}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00044}00044         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a61c99f69bf5feb2ac95189381a48e638}{bind}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00046}00046         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a33dd21c340b2ea4cdfda0c4306883275}{preRender}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00048}00048         \textcolor{comment}{// Create RenderBatches (uploading them to the bound texture, so that we can actually draw them next.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00049}00049         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a0a92a001f43456e84a72c579901311f7}{createRenderBatches}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00051}00051         \textcolor{comment}{// Now we can render each renderbatch, uploading their texture data respectively.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00052}00052         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}.size(); i++) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00053}00053             \textcolor{comment}{// Bind the texture information to the texture "{}slot"{}}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00054}00054             \textcolor{comment}{// This method of binding the textures decreases speed slightly for completely random textures, but if we are rendering a lot of the same texture, this is similar (if not identical) to instance rendering.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00056}00056             glContext-\/>\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{setActiveTexture}}(GL\_TEXTURE1);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00057}00057             glContext-\/>\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{bindTexture}}(GL\_TEXTURE\_2D, \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a34c6156003e155272b59ea39413ecda2}{m\_batchBumpmaps}}[i]);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00059}00059             glContext-\/>\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a529bb80b0bd7bbf86f10be7c30be514c}{setActiveTexture}}(GL\_TEXTURE0);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00060}00060             glContext-\/>\mbox{\hyperlink{class_b_a_r_e2_d_1_1_g_l_context_a1815cdbe70cc6fdbc66ec69a7131b5be}{bindTexture}}(GL\_TEXTURE\_2D, \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}[i].textureID);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00062}00062             \textcolor{comment}{// Upload the data}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00063}00063             glDrawArrays(GL\_TRIANGLES, (GLint)\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}[i].offset, (GLsizei)\mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}[i].numVertices);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00064}00064         \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00066}00066         \textcolor{comment}{// Unbind for safety!}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00067}00067         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a6c224737a43f43dbe7c9e25ecd47d1da}{unbind}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00069}00069         \textcolor{comment}{// Release the shader}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00070}00070         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a6cca43c8d777b64314256241af1df295}{m\_shader}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_shader_program_a7847844b8a2e5ab0677340b47d180841}{unuse}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00071}00071     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00073}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a6480bb55821d44b19fcd964a21c7dc5d}{00073}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a6480bb55821d44b19fcd964a21c7dc5d}{BumpyRenderer::draw}}(glm::vec4 destRect, glm::vec4 uvRect, GLuint texture, \textcolor{keywordtype}{float} depth, \mbox{\hyperlink{struct_b_a_r_e2_d_1_1_colour}{Colour}} colour\textcolor{comment}{/* = Colour(255, 255, 255, 255)*/}, \textcolor{keywordtype}{float} angle\textcolor{comment}{/* = 0.0f*/}, glm::vec2 COR\textcolor{comment}{/* = glm::vec2(0.5f)*/}) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00074}00074         \mbox{\hyperlink{namespace_b_a_r_e2_d_aed4332e42208fed2905a8b0845dad4d1}{throwFatalError}}(\mbox{\hyperlink{namespace_b_a_r_e2_d_a598d6ee5637b8d61de038646a6674f15abcb313a5c9f8965d7b75833af33d16be}{BAREError::UNINITIALIZED\_FUNCTION}}, \textcolor{stringliteral}{"{}BumpyRenderer drawing without bumpmap texture! Fix your program!"{}});}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00075}00075     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00077}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a75f6fb8242a8b04fe90421ad0c0f442e}{00077}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a6480bb55821d44b19fcd964a21c7dc5d}{BumpyRenderer::draw}}(glm::vec4 destRect, glm::vec4 uvRect, GLuint texture, GLuint bumpmap, \textcolor{keywordtype}{float} depth, \mbox{\hyperlink{struct_b_a_r_e2_d_1_1_colour}{Colour}} colour\textcolor{comment}{/* = Colour(255, 255, 255, 255)*/}, \textcolor{keywordtype}{float} angle\textcolor{comment}{/* = 0.0f*/}, glm::vec2 COR\textcolor{comment}{/* = glm::vec2(0.5f)*/}) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00078}00078         \textcolor{comment}{// Make sure it's actually in the scene.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00079}00079         \textcolor{keywordflow}{if}(!\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a741e3e451e464391ae3c549ec34866db}{m\_camera}}-\/>isRectInViewspace(destRect))}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00080}00080             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00082}00082         \textcolor{comment}{// Just add the glyph (as a bumpy glyph!)}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00083}00083         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}.push\_back(\textcolor{keyword}{new} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph}{BumpyGlyph}}(destRect, uvRect, texture, bumpmap, depth, colour, angle, COR));}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00084}00084     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00086}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a0a92a001f43456e84a72c579901311f7}{00086}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a0a92a001f43456e84a72c579901311f7}{BumpyRenderer::createRenderBatches}}() \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00087}00087         \textcolor{comment}{// Create all the render batches (based on the draw()'n glyphs) for rendering}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00088}00088         \textcolor{comment}{// THey're going to end up as vertices}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00089}00089         std::vector<Vertex> vertices;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00091}00091         \textcolor{comment}{// We already know that the glyphs represent 6 vertices by design.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00092}00092         vertices.resize(\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}.size() * 6);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00094}00094         \textcolor{comment}{// Check if we even have anything to draw}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00095}00095         \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}.size() == 0) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00096}00096             \textcolor{keywordflow}{return}; \textcolor{comment}{// Don't need to do much.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00097}00097         \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00099}00099         \textcolor{keywordtype}{int} offset = 0;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00100}00100         \textcolor{keywordtype}{int} vertex = 0;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00102}00102         \textcolor{comment}{// Make way for new bumpmaps.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00103}00103         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a34c6156003e155272b59ea39413ecda2}{m\_batchBumpmaps}}.clear();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00105}00105         \textcolor{comment}{// 'Draw' two triangles from the 6 vertices.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00106}00106         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}.emplace\_back(offset, 6, \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>texture);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00107}00107         vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>topLeft;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00108}00108         vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>bottomLeft;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00109}00109         vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>bottomRight;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00110}00110         vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>bottomRight;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00111}00111         vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>topRight;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00112}00112         vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0]-\/>topLeft;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00113}00113         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a34c6156003e155272b59ea39413ecda2}{m\_batchBumpmaps}}.push\_back(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph}{BumpyGlyph}}*\textcolor{keyword}{>}(\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[0])-\/>bumpmap);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00114}00114 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00115}00115         \textcolor{comment}{// Set the offset appropriately for 6 vertices of data.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00116}00116         offset += 6;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00118}00118         \textcolor{comment}{// Add the rest of the glyphs}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00119}00119         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} glyph = 1; glyph < \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}.size(); glyph++) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00120}00120             \textcolor{comment}{// Check if this can just be part of the current batch (instancing essentially)}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00121}00121             \textcolor{comment}{// They must have both the same texture AND the same bumpmap for this to work properly.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00122}00122             \textcolor{keywordflow}{if}((\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>texture != \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph -\/ 1]-\/>texture) || (\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph}{BumpyGlyph}}*\textcolor{keyword}{>}(\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph])-\/>bumpmap != \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph}{BumpyGlyph}}*\textcolor{keyword}{>}(\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph -\/ 1])-\/>bumpmap)) \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00123}00123                 \textcolor{comment}{// It can't be part of the same batch, so create a new one}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00124}00124                 \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}.emplace\_back(offset, 6, \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>texture);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00125}00125                 \textcolor{comment}{// Add the corresponding bumpmap to the batch bumpmaps vector.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00126}00126                 \mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_renderer_a34c6156003e155272b59ea39413ecda2}{m\_batchBumpmaps}}.push\_back(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_b_a_r_e2_d_1_1_bumpy_glyph}{BumpyGlyph}}*\textcolor{keyword}{>}(\mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph])-\/>bumpmap);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00127}00127             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00128}00128                 \textcolor{comment}{// If its part of the current batch, just increase numVertices. It'll reuse the texture, but nothing more.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00129}00129                 \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_a4a5d71addd82c34de80ab86704a4f847}{m\_batches}}.back().numVertices += 6;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00130}00130             \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00131}00131             \textcolor{comment}{// 'Draw' two triangles.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00132}00132             vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>topLeft;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00133}00133             vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>bottomLeft;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00134}00134             vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>bottomRight;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00135}00135             vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>bottomRight;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00136}00136             vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>topRight;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00137}00137             vertices[vertex++] = \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}[glyph]-\/>topLeft;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00139}00139             \textcolor{comment}{// Push data offset forward 6 vertices.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00140}00140             offset += 6;}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00141}00141         \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00143}00143         \textcolor{comment}{// Done with the glyphs, we can clear em}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00144}00144         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_basic_renderer_a6e87400292d586ff1a8d4634856161db}{m\_glyphs}}.clear();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00146}00146         \textcolor{comment}{// Now that render batches are created, we can upload the information to OpenGL}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00148}00148         \textcolor{comment}{// Bind the VBO}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00149}00149         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_aaaec16d98be94aa5cfed015df40dda70}{bindVBO}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00151}00151         \textcolor{comment}{// Orphan the buffer}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00152}00152         glBufferData(GL\_ARRAY\_BUFFER, vertices.size() * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_b_a_r_e2_d_1_1_vertex}{Vertex}}), \textcolor{keyword}{nullptr}, GL\_DYNAMIC\_DRAW);}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00154}00154         \textcolor{comment}{// Actually upload the data to the buffer.}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00155}00155         glBufferSubData(GL\_ARRAY\_BUFFER, 0, vertices.size() * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_b_a_r_e2_d_1_1_vertex}{Vertex}}), vertices.data());}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00156}00156 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00157}00157         \textcolor{comment}{// Unbind the VBO again for safety}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00158}00158         \mbox{\hyperlink{class_b_a_r_e2_d_1_1_renderer_ad9672b3d262d65d40589a6cfec480e4c}{m\_vertexArrayObject}}.\mbox{\hyperlink{class_b_a_r_e2_d_1_1_v_a_o_a10dd3e06e3929147edb6b249c94fdcee}{unbindVBO}}();}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00159}00159     \}}
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{_bumpy_renderer_8cpp_source_l00161}00161 \}}

\end{DoxyCode}
